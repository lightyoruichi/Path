(function(g){function e(c){this.filter(e.resizableFilterSelector).each(function(){new h(g(this),c)});return this}function h(c,d){c.data("AutoResizer")&&c.data("AutoResizer").destroy();d=this.config=g.extend({},e.defaults,d);this.el=c;this.nodeName=c[0].nodeName.toLowerCase();this.originalHeight=c.height();this.previousScrollTop=null;this.value=c.val();if("original"===d.maxWidth)d.maxWidth=c.width();if("original"===d.minWidth)d.minWidth=c.width();if("original"===d.maxHeight)d.maxHeight=c.height();
if("original"===d.minHeight)d.minHeight=c.height();"textarea"===this.nodeName&&c.css({resize:"none",overflowY:"hidden"});c.data("AutoResizer",this);d.animate.complete=function(b){return function(){d.onAfterResize.call(c);return b.apply(this,arguments)}}(d.animate.complete);this.bind()}var i="ar"+ +new Date;e.defaults={onResize:function(){},onBeforeResize:function(){return 123},onAfterResize:function(){return 555},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,
minWidth:"original",maxWidth:500};e.cloneCSSProperties="lineHeight,textDecoration,letterSpacing,fontSize,fontFamily,fontStyle,fontWeight,textTransform,textAlign,direction,wordSpacing,fontSizeAdjust,paddingTop,paddingLeft,paddingBottom,paddingRight,width".split(",");e.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden"};e.resizableFilterSelector=["textarea:not(textarea."+i+")","input:not(input[type]),input[type=text],input[type=password],input[type=email],input[type=url]"].join();
e.AutoResizer=h;g.fn.autoResize=e;h.prototype={bind:function(){var c=g.proxy(function(){this.check();return!0},this);this.unbind();this.el.bind("keyup.autoResize",c).bind("change.autoResize",c).bind("paste.autoResize",function(){setTimeout(function(){c()},0)});this.el.is(":hidden")||this.check(null,!0)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var c=this.el,d="textarea"===this.nodeName?c.clone():g("<span/>");this.clone=d;g.each(e.cloneCSSProperties,function(b,a){d[0].style[a]=
c.css(a)});d.removeAttr("name").removeAttr("id").addClass(i).attr("tabIndex",-1).css(e.cloneCSSValues);"textarea"===this.nodeName?d.height("auto"):d.width("auto").css({whiteSpace:"nowrap"})},check:function(c,d){this.clone||(this.createClone(),this.injectClone());var b=this.config,a=this.clone,f=this.el,e=f.val();if(e===this.prevValue)return!0;this.prevValue=e;if("input"===this.nodeName){if(a.text(e),a=a.width(),a=a+b.extraSpace>=b.minWidth?a+b.extraSpace:b.minWidth,e=f.width(),a=Math.min(a,b.maxWidth),
a<e&&a>=b.minWidth||a>=b.minWidth&&a<=b.maxWidth)b.onBeforeResize.call(f),b.onResize.call(f),f.scrollLeft(0),b.animate&&!d?f.stop(1,1).animate({width:a},b.animate):(f.width(a),b.onAfterResize.call(f))}else if(a.width(f.width()).height(0).val(e).scrollTop(1E4),a=a[0].scrollTop,this.previousScrollTop!==a)this.previousScrollTop=a,a+b.extraSpace>=b.maxHeight?(f.css("overflowY",""),a=b.maxHeight,d=!0):a<=b.minHeight?a=b.minHeight:(f.css("overflowY","hidden"),a+=b.extraSpace),b.onBeforeResize.call(f),b.onResize.call(f),
b.animate&&!d?f.stop(1,1).animate({height:a},b.animate):(f.height(a),b.onAfterResize.call(f))},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clone.remove();delete this.el;delete this.clone},injectClone:function(){(e.cloneContainer||(e.cloneContainer=g("<arclones/>").appendTo("body"))).append(this.clone)}}})(jQuery);
